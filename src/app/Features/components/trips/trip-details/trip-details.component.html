<!-- trip-details.component.html -->
<div class="trip-details-container">
  <div class="top-section">
    <div class="left-column">
      <div class="media-slider">
        <p-galleria
          [value]="images"
          [responsiveOptions]="responsiveOptions"
          [containerStyle]="{ 'max-width': '100%', margin: '0 auto' }"
          [numVisible]="5"
          [circular]="true"
          [showItemNavigators]="true"
          [showThumbnails]="true"
          [showIndicators]="true"
        >
          <ng-template pTemplate="item" let-item>
            <div class="galleria-item">
              <img [src]="item.url" [alt]="trip?.title" class="hero-image" />
            </div>
          </ng-template>
          <ng-template pTemplate="thumbnail" let-item>
            <div class="galleria-thumbnail">
              <img [src]="item.url" [alt]="trip?.title" />
            </div>
          </ng-template>
        </p-galleria>
      </div>

      <div class="trip-highlights">
        <h3>Trip Highlights</h3>
        <ul>
          <li><i class="pi pi-check-circle"></i> Professional Guide</li>
          <li><i class="pi pi-check-circle"></i> Safety Equipment</li>
          <li><i class="pi pi-check-circle"></i> Refreshments Included</li>
          <li><i class="pi pi-check-circle"></i> Photo Opportunities</li>
        </ul>
      </div>
    </div>

    <div class="right-column">
      <div class="trip-main-details">
        <div class="details-header">
          <h1>{{ trip?.title }}</h1>
          <p-tag
            [value]="trip?.category"
            severity="info"
            styleClass="category-tag"
          ></p-tag>
        </div>

        <div class="trip-meta">
          <div class="meta-info">
            <i class="pi pi-clock"></i>
            <div class="meta-content">
              <h4>Duration</h4>
              <p>{{ trip?.duration }}</p>
            </div>
          </div>
          <div class="meta-info">
            <i class="pi pi-map-marker"></i>
            <div class="meta-content">
              <h4>Location</h4>
              <p>{{ trip?.location }}</p>
            </div>
          </div>
          <div class="meta-info">
            <i class="pi pi-dollar"></i>
            <div class="meta-content">
              <h4>Price</h4>
              <p>${{ trip?.price }}</p>
            </div>
          </div>
        </div>

        <div class="trip-description">
          <h3>Description</h3>
          <p>{{ trip?.description }}</p>
        </div>

        <!-- Safari Map Section with Animation and Interactivity -->
        <div class="destination-curve-container">
          <div class="safari-banner">
            <h2>انطلق في مغامرتك في جبال البحر الأحمر!</h2>
            <button
              pButton
              label="احجز رحلتك الآن"
              class="p-button-warning mt-2"
            ></button>
          </div>

          <svg viewBox="0 0 1000 200" class="curve-svg">
            <!-- المسار المنقط -->
            <image xlink:href="assets/quad.png" width="60" height="60">
              <animateMotion dur="10s" repeatCount="indefinite" rotate="auto">
                <mpath xlink:href="#path" />
              </animateMotion>
            </image>
            <path
              id="path"
              d="M 50 150 C 250 50, 750 50, 950 150"
              stroke="#00b4d8"
              stroke-dasharray="10,10"
              stroke-width="4"
              fill="transparent"
            >
              <animate
                attributeName="stroke-dashoffset"
                from="1000"
                to="0"
                dur="3s"
                repeatCount="1"
                fill="freeze"
              />
            </path>

            <!-- نقاط الوجهات -->
            <circle cx="50" cy="150" r="8" fill="#0077b6" />
            <text x="30" y="140" class="location-label">نقطة البداية</text>

            <circle cx="250" cy="90" r="8" fill="#0077b6" />
            <text x="230" y="80" class="location-label">الوادي الرملي</text>

            <circle cx="500" cy="50" r="8" fill="#0077b6" />
            <text x="480" y="40" class="location-label">قمة الجبل</text>

            <circle cx="750" cy="90" r="8" fill="#0077b6" />
            <text x="730" y="80" class="location-label">نقطة تصوير</text>

            <circle cx="950" cy="150" r="8" fill="#0077b6" />
            <text x="930" y="140" class="location-label">النهاية</text>
          </svg>
        </div>

        <div class="trip-rating">
          <h3>Rating</h3>
          <p-rating [ngModel]="trip?.rating" [readonly]="true"></p-rating>
        </div>

        <div class="footer">
          <button
            pButton
            label="Book Now"
            icon="pi pi-check"
            class="p-button-success"
          ></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Hero Video Section -->
  <div class="hero-video-section" *ngIf="videos.length > 0">
    <div class="video-banner" (click)="playHeroVideo()">
      <img
        [src]="getVideoThumbnail(videos[0].url)"
        class="video-poster"
        alt="Trip Video"
      />
      <div class="overlay">
        <i class="pi pi-play play-btn"></i>
        <p class="caption">Ready for Adventures!</p>
      </div>
    </div>

    <div class="popup-video" *ngIf="showHeroVideo">
      <div class="video-wrapper">
        <video controls autoplay (ended)="closeHeroVideo()">
          <source [src]="videos[0].url" type="video/mp4" />
        </video>
        <button class="close-btn" (click)="closeHeroVideo()">&times;</button>
      </div>
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="reviews-section">
    <h2>Client Reviews</h2>
    <div class="reviews-container">
      <div *ngFor="let review of reviews" class="review-card">
        <div class="user-info">
          <h3>{{ review.userName }}</h3>
          <small>{{ review.date }}</small>
        </div>
        <p-rating [ngModel]="review.rating" [readonly]="true"></p-rating>
        <p class="review-comment">{{ review.comment }}</p>
      </div>
    </div>
  </div>
</div>
