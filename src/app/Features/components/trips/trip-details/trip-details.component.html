<!-- trip-details.component.html -->
<div class="trip-details-container">
  <div class="header-container">
    <h1 class="trip-title">
      {{
        trip?.title ||
          "Giza pyramids, Sphinx, ATV bike, Lunch,Camel ride, Dinner cruise& shopping tour"
      }}
    </h1>
    <div class="breadcrumb-container">
      <div class="breadcrumb-path"></div>
      <div class="contact-info">
        <span
          ><i class="pi pi-phone"></i> Book online or call: +1(702)
          648-5873</span
        >
        <span><i class="pi pi-comments"></i> Chat now</span>
      </div>
    </div>
    <div class="rating-summary">
      <div class="stars">
        <p-rating [ngModel]="trip?.rating || 5" [readonly]="true"></p-rating>
        <span class="review-count">{{ trip?.reviewCount || 634 }} Reviews</span>
      </div>
      <div class="trip-badges">
        <span class="badge"
          ><i class="pi pi-thumbs-up"></i> Recommended by 99% of travelers</span
        >
        <span class="badge"
          ><i class="pi pi-star"></i> Badge of Excellence</span
        >
        <span class="location"
          ><i class="pi pi-map-marker"></i>
          {{ trip?.location || "Cairo, Egypt" }}</span
        >
      </div>
      <div class="price-guarantee">
        <i class="pi pi-check-circle"></i> Lowest Price Guarantee
      </div>
    </div>
  </div>

  <div class="content-wrapper">
    <div class="top-section">
      <div class="left-column">
        <div class="">
          <div class="custom-gallery">
            <div class="thumbnails-column">
              <div
                class="thumbnail"
                *ngFor="let image of images; let i = index"
                [class.active]="currentIndex === i"
                (click)="setActiveImage(i)"
              >
                <img [src]="image.url" [alt]="trip?.title" />
              </div>
            </div>
            <div class="main-image">
              <button
                class="nav-btn prev"
                (click)="prevImage()"
                *ngIf="currentIndex > 0"
              >
                <i class="pi pi-chevron-left"></i>
              </button>
              <img [src]="images[currentIndex].url" [alt]="trip?.title" />
              <button
                class="nav-btn next"
                (click)="nextImage()"
                *ngIf="currentIndex < images.length - 1"
              >
                <i class="pi pi-chevron-right"></i>
              </button>
              <div class="image-actions">
                <button class="action-btn">
                  <i class="pi pi-share-alt"></i>
                </button>
                <button class="action-btn"><i class="pi pi-heart"></i></button>
              </div>
            </div>
          </div>
        </div>

        <div class="trip-info-section">
          <div class="trip-highlights">
            <h3>Trip Highlights</h3>
            <ul>
              <li><i class="pi pi-check-circle"></i> Professional Guide</li>
              <li><i class="pi pi-check-circle"></i> Safety Equipment</li>
              <li><i class="pi pi-check-circle"></i> Refreshments Included</li>
              <li><i class="pi pi-check-circle"></i> Photo Opportunities</li>
            </ul>
          </div>

          <!-- <div class="trip-description">
            <h3>Description</h3>
            <p>{{ trip?.description }}</p>
          </div> -->

          <!-- <div class="destination-curve-container">
            <div class="safari-banner">
              <h2>انطلق في مغامرتك في جبال البحر الأحمر!</h2>
              <button
                pButton
                label="احجز رحلتك الآن"
                class="p-button-warning mt-2"
              ></button>
            </div>

            <svg viewBox="0 0 1000 200" class="curve-svg">
              <image xlink:href="assets/quad.png" width="60" height="60">
                <animateMotion dur="10s" repeatCount="indefinite" rotate="auto">
                  <mpath xlink:href="#path" />
                </animateMotion>
              </image>
              <path
                id="path"
                d="M 50 150 C 250 50, 750 50, 950 150"
                stroke="#00b4d8"
                stroke-dasharray="10,10"
                stroke-width="4"
                fill="transparent"
              >
                <animate
                  attributeName="stroke-dashoffset"
                  from="1000"
                  to="0"
                  dur="3s"
                  repeatCount="1"
                  fill="freeze"
                />
              </path>

              <circle cx="50" cy="150" r="8" fill="#0077b6" />
              <text x="30" y="140" class="location-label">نقطة البداية</text>

              <circle cx="250" cy="90" r="8" fill="#0077b6" />
              <text x="230" y="80" class="location-label">الوادي الرملي</text>

              <circle cx="500" cy="50" r="8" fill="#0077b6" />
              <text x="480" y="40" class="location-label">قمة الجبل</text>

              <circle cx="750" cy="90" r="8" fill="#0077b6" />
              <text x="730" y="80" class="location-label">نقطة تصوير</text>

              <circle cx="950" cy="150" r="8" fill="#0077b6" />
              <text x="930" y="140" class="location-label">النهاية</text>
            </svg>
          </div> -->

          <div class="trip-meta">
            <div class="meta-info">
              <i class="pi pi-clock"></i>
              <div class="meta-content">
                <h4>Duration</h4>
                <p>{{ trip?.duration }}</p>
              </div>
            </div>
            <div class="meta-info">
              <i class="pi pi-map-marker"></i>
              <div class="meta-content">
                <h4>Location</h4>
                <p>{{ trip?.location }}</p>
              </div>
            </div>
            <div class="meta-info">
              <i class="pi pi-users"></i>
              <div class="meta-content">
                <h4>Group Size</h4>
                <p>{{ trip?.groupSize }}</p>
              </div>
            </div>
          </div>

          <div class="trip-features">
            <div class="feature">
              <i class="pi pi-clock"></i> 12 hours (approx.)
            </div>
            <div class="feature"><i class="pi pi-car"></i> Pickup offered</div>
            <div class="feature">
              <i class="pi pi-mobile"></i> Mobile ticket
            </div>
            <div class="feature">
              <i class="pi pi-globe"></i> Offered in: English and 2 more
            </div>
          </div>
        </div>
      </div>

      <div class="right-column">
        <div class="booking-card">
          <div class="price-section">
            <h2>
              From ${{ trip?.pricePerPerson || "65.00" }}
              <span class="per-person">per person</span>
            </h2>
            <p class="price-note">Price varies by group size</p>
          </div>

          <div class="booking-form">
            <h3>Select Date and Travelers</h3>

            <div class="form-group">
              <label><i class="pi pi-calendar"></i> Date</label>
              <p-calendar
                [(ngModel)]="selectedDate"
                [minDate]="minDate"
                [showIcon]="true"
                dateFormat="dd/mm/yy"
                [readonlyInput]="true"
                styleClass="w-full"
              >
              </p-calendar>
            </div>

            <div class="form-group">
              <label><i class="pi pi-users"></i> Travelers</label>
              <div class="travelers-picker" (click)="op.toggle($event)">
                <span
                  >{{ totalTravelers }} Travelers ({{ adults }} Adults,
                  {{ children }} Children)</span
                >
              </div>

              <p-overlayPanel #op>
                <div class="travelers-selector">
                  <div class="traveler-type">
                    <div class="type-label">
                      <span>Adults</span>
                      <small>Age 13+</small>
                    </div>
                    <p-inputNumber
                      [(ngModel)]="adults"
                      [showButtons]="true"
                      [min]="1"
                      [max]="10"
                    ></p-inputNumber>
                  </div>
                  <div class="traveler-type">
                    <div class="type-label">
                      <span>Children</span>
                      <small>Age 2-12</small>
                    </div>
                    <p-inputNumber
                      [(ngModel)]="children"
                      [showButtons]="true"
                      [min]="0"
                      [max]="10"
                    ></p-inputNumber>
                  </div>
                </div>
              </p-overlayPanel>
            </div>

            <button
              pButton
              label="Check Availability"
              class="p-button-success check-btn"
            ></button>
          </div>

          <div class="booking-features">
            <div class="feature">
              <i class="pi pi-check-circle"></i> Free cancellation
              <span
                >up to 24 hours before the experience starts (local time)</span
              >
            </div>
            <div class="feature">
              <i class="pi pi-check-circle"></i> Reserve Now and Pay Later
              <span>Secure your spot while staying flexible</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="hero-video-section" *ngIf="videos.length > 0">
    <div class="video-banner" (click)="playHeroVideo()">
      <img
        [src]="getVideoThumbnail(videos[0].url)"
        class="video-poster"
        alt="Trip Video"
      />
      <div class="overlay">
        <i class="pi pi-play play-btn"></i>
        <p class="caption">Ready for Adventures!</p>
      </div>
    </div>

    <div class="popup-video" *ngIf="showHeroVideo">
      <div class="video-wrapper">
        <video controls autoplay (ended)="closeHeroVideo()">
          <source [src]="videos[0].url" type="video/mp4" />
        </video>
        <button class="close-btn" (click)="closeHeroVideo()">&times;</button>
      </div>
    </div>
  </div>

  <app-reviews [tripId]="trip?.id || 0"></app-reviews>
</div>
